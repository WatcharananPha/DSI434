python
import json

def convert_tsv_to_json_lines(tsv_string, sheet_name="Risk_Criteria"):
    json_lines_output = []
    
    # 1. Read TSV and pre-process cells
    raw_lines = tsv_string.strip().split('\n')
    
    clean_rows = []
    for line in raw_lines:
        # Trim leading/trailing spaces and collapse internal newlines to a single space
        cells = [cell.strip().replace('\n', ' ') for cell in line.split('\t')]
        
        # Drop rows with all-empty columns (after cleaning)
        # A row is considered empty if all its cells are empty strings.
        if any(cell for cell in cells):
            clean_rows.append(cells)

    i = 0
    while i < len(clean_rows):
        row = clean_rows[i]
        
        # --- Handle Probability Criteria Chunk ---
        # Pattern: ['เกณฑ์การประเมินโอกาสเกิด', 'ต่ำ', 'ปานกลาง', 'สูง', 'รุนแรง', ''] (col 0, col 1 for 'ต่ำ')
        if row[0] == 'เกณฑ์การประเมินโอกาสเกิด' and len(row) > 1 and row[1] == 'ต่ำ':
            chunk_row_index = 0
            
            # The next two rows are headers for levels 1-4 scores and labels
            # Level labels (ต่ำ, ปานกลาง, สูง, รุนแรง) are in current row, cols 1-4
            # Level scores (1, 2, 3, 4) are in the next row, cols 1-4
            level_scores = clean_rows[i+1][1:5] 
            
            # Data row 1: Thresholds (2 rows after the main header)
            if i + 2 < len(clean_rows):
                data_row_1 = clean_rows[i+2]
                # Check if values exist for the levels (cols 1-4 of data_row_1)
                if any(data_row_1[k+1] for k in range(4)): 
                    chunk_row_index += 1
                    data_obj = {
                        "criterion": data_row_1[0] if data_row_1[0] else "โอกาสเกิด", # Default if empty
                        "type": "threshold"
                    }
                    for k in range(4):
                        data_obj[f"level_{k+1}_score"] = level_scores[k]
                        data_obj[f"level_{k+1}_value"] = data_row_1[k+1]
                    json_lines_output.append(json.dumps({
                        "sheet": sheet_name,
                        "row_index": chunk_row_index,
                        "data": data_obj
                    }, ensure_ascii=False))

            # Data row 2: Descriptions (3 rows after the main header)
            if i + 3 < len(clean_rows):
                data_row_2 = clean_rows[i+3]
                # Check if values exist for the levels (cols 1-4 of data_row_2)
                if any(data_row_2[k+1] for k in range(4)): 
                    chunk_row_index += 1
                    data_obj = {
                        "criterion": data_row_2[0] # Try to get from current row
                    }
                    # Fallback to previous object's criterion if current is empty
                    if not data_obj["criterion"] and json_lines_output: 
                        try:
                            prev_obj = json.loads(json_lines_output[-1])
                            if prev_obj.get('data', {}).get('criterion'):
                                data_obj["criterion"] = prev_obj['data']['criterion']
                        except json.JSONDecodeError:
                            pass # Should not happen with well-formed JSON
                    data_obj["type"] = "description"
                    
                    for k in range(4):
                        data_obj[f"level_{k+1}_score"] = level_scores[k]
                        data_obj[f"level_{k+1}_value"] = data_row_2[k+1]
                    json_lines_output.append(json.dumps({
                        "sheet": sheet_name,
                        "row_index": chunk_row_index,
                        "data": data_obj
                    }, ensure_ascii=False))
            
            i += 4 # Advance past 2 header rows and 2 data rows for probability chunk
            continue

        # --- Handle Impact/Severity Criteria Chunks ---
        # Look for the 'เกณฑ์การประเมินผลกระทบ (Impact)' header which signifies the start of a new impact block.
        # This header can be in column 0 or column 1.
        is_impact_block_start = False
        if row[0] == 'เกณฑ์การประเมินผลกระทบ (Impact)':
            is_impact_block_start = True
        elif len(row) > 1 and row[1] == 'เกณฑ์การประเมินผลกระทบ (Impact)':
            is_impact_block_start = True
            
        if is_impact_block_start:
            # Step 1: Collect all data rows for this impact block
            collected_data_rows = []
            
            j = i + 3 # Data rows start after 3 header rows (the Impact header itself and 2 rows below it)
            while j < len(clean_rows):
                data_row = clean_rows[j]
                
                # Check for end of this impact chunk:
                # If we encounter a new header pattern (probability or another impact block), break.
                if (data_row[0] == 'เกณฑ์การประเมินโอกาสเกิด' and len(data_row) > 1 and data_row[1] == 'ต่ำ') or \
                   (data_row[0] == 'เกณฑ์การประเมินผลกระทบ (Impact)' or (len(data_row) > 1 and data_row[1] == 'เกณฑ์การประเมินผลกระทบ (Impact)')):
                    break 

                # Drop rows if all cells in relevant data columns (0-5) are empty after cleaning
                if all(cell == '' for cell in data_row[0:6]):
                    j += 1
                    continue
                
                collected_data_rows.append(data_row)
                j += 1
            
            # Step 2: Determine the effective_main_category for this entire collected block
            # This category is usually found in Col 0 of one of the data rows, 
            # and it applies to all rows in its logical group.
            effective_main_category = ""
            for dr in collected_data_rows:
                # Find the first non-empty cell in Col 0 that is not a numeric identifier (like -1, -2)
                # and not an 'Unnamed' column header.
                if dr[0] and not dr[0].startswith('-') and not dr[0].startswith('Unnamed'):
                    effective_main_category = dr[0]
                    break
            
            # Step 3: Iterate through collected data rows again to generate JSON objects
            chunk_row_index = 0
            for dr in collected_data_rows:
                chunk_row_index += 1
                data_obj = {
                    "main_category": effective_main_category, # Use the determined category for the entire group
                    "sub_category": dr[1],
                    "level_low_value": dr[2],
                    "level_medium_value": dr[3],
                    "level_high_value": dr[4],
                    "level_severe_value": dr[5],
                }
                
                json_lines_output.append(json.dumps({
                    "sheet": sheet_name,
                    "row_index": chunk_row_index,
                    "data": data_obj
                }, ensure_ascii=False))
            
            i = j # Move main iterator to where this chunk processing ended
            continue
            
        # If no specific chunk header pattern was found, advance the main iterator
        i += 1
        
    return "\n".join(json_lines_output)

# Provided TSV content
tsv_content = """
Unnamed: 0	Unnamed: 1	Unnamed: 2	Unnamed: 3	Unnamed: 4	Unnamed: 5
เกณฑ์การประเมินโอกาสเกิด					
	ระดับ				
เกณฑ์การประเมินโอกาสเกิด	  ต่ำ	ปานกลาง	สูง	รุนแรง	
	1	2	3	4	
โอกาสเกิด	<10%	>10% ถึง <20%	>20% ถึง <50%	>50% 	
	ไม่เคย/เคยเกิด 1 ครั้งใน 5 ปี	เคยเกิด 1 ครั้งใน 3 ปี	เคยเกิด 1 ครั้งใน 1 ปี	เคยเกิดขึ้น>1ครั้งใน 1 ปี	
					
					
					
					
					
เกณฑ์การประเมินความรุนแรง					
เกณฑ์การประเมินผลกระทบ (Impact)		ระดับ			
		ต่ำ	ปานกลาง	สูง	รุนแรง
		1	2	3	4
	กำไรสุทธิต่ำกว่าเป้าหมาย	< 1.25%	>1.25% ถึง <2.5%	>2.5% ถึง <5%	>5%
	(Net Profit)				
	กำไรขั้นต่ำกว่าเป้าหมาย	< 1.25%	>1.25% ถึง <2.5%	>2.5% ถึง <5%	>5%
-1	(EBITDA)				
ด้านการเงิน (Financial)	รายได้ต่ำกว่าเป้าหมาย	< 1.25%	>1.25% ถึง <2.5%	>2.5% ถึง <5%	>5%
	(Revenue)				
	ค่าใช้จ่ายสูงกว่าเป้าหมาย	< 1.25%	>1.25% ถึง <2.5%	>2.5% ถึง <5%	>5%
	(Expense)				
	ผลตอบแทนการลงทุนต่ำกว่าเป้าหมาย	< 5% 	>5% ถึง <10%	>10% ถึง <15%	>15%
	(Project Return Equity IRR)	จาก base case	จาก base case	จาก base case	จาก base case
	มูลค่าความเสียหายต่อการผลิตและเครื่องจักร/อุปกรณ์	< 75 ล้านบาท	>75 ถึง <150 ล้านบาท	>150 ถึง <300 ล้านบาท	>300 ล้านบาท
	งบประมานลงทุนสูงกว่าที่ได้รับอนุมัติ	< 1.25% 	>1.25% ถึง <2.5%	>2.5% ถึง <5%	>5%
	(Project Cost Overrun)	จาก base case	จาก base case	จาก base case	จาก base case
					
เกณฑ์การประเมินผลกระทบ (Impact)		ระดับ			
		ต่ำ	ปานกลาง	สูง	รุนแรง
		1	2	3	4
-2	การปฏิบัติตามกฏหมาย/  กฏระเบียบ/  ข้อบังคับ	ขัดต่อกฎระเบียบ/ข้อบังคับ/ข้อกำหนดตามมาตรฐานต่างๆ ของบริษัท	ขัดต่อกฎหมาย กฎระเบียบของหน่วยงานภายนอกที่กำกับดูแล ซึ่งกระทบต่อการดำเนินงานของบริษัท แต่สามารถดำเนินการแก้ไขได้ทันที	ขัดต่อกฎหมาย กฎระเบียบของหน่วยงานภายนอกที่กำกับดูแล โดยได้รับบทลงโทษตามกฎหมาย หรือต้องแก้ไขตามคำสั้่งของหน่วยงานภายนอกที่กำกับดูแล	ขัดต่อกฎหมาย กฎระเบียบของหน่วยงานภายนอกที่กำกับดูแลโดยถูกเพิกถอนใบอนุญาตหรือถูกปิดกิจการ
กฏหมาย   กฏระเบียบ ข้อบังคับ และสัญญา / ข้อตกลงระดับของการให้บริการ	ข้อตกลงระดับของการให้บริการ	ได้รับคำแจ้งเตือนจากลูกค้าและพิจารณาดำเนินการแก้ไข	เริ่มดำเนินการแก้ไขภายใต้สัญญา	ดำเนินการแก้ไขตามที่สัญญากำหนดไว้	ไม่สามารถดำเนินการแก้ไขตามสัญญา ทำให้ลูกค้ายกเลิกสัญญา
					
เกณฑ์การประเมินผลกระทบ (Impact)		ระดับ			
		ต่ำ	ปานกลาง	สูง	รุนแรง
		1	2	3	4
		พนักงาน ลูกค้า คู่ค้า หรือผู้มีส่วนได้ส่วนเสียได้รับบาดเจ็บจนต้องได้รับการปฐมพาบาลทางการแพทย์ แต่ไม่หยุดงาน	พนักงาน ลูกค้า คู่ค้า หรือผู้มีส่วนได้ส่วนเสียได้รับบาดเจ็บจนต้องได้รับการรักษาทางการแพทย์ (OPD) โดยไม่ต้องเข้าพักรักษาในโรงพยาบาล	พนักงาน ลูกค้า คู่ค้า หรือผู้มีส่วนได้ส่วนเสียได้รับบาดเจ็บหนักจนต้องเข้ารับการรักษาในโรงพยาบาล (IPD) 	พนักงาน ลูกค้า คู่ค้า หรือผู้มีส่วนได้ส่วนเสียได้รับบาดเจ็บหนักจนทุพลภาพ หรือเสียชีวิต
					
	อาชีวอนามัยและ				
-3	ความปลอดภัย 				
ความปลอดภัย					
อาชีวอนามัยของบุคลากร					
(Occupational Health & Safety) 		พนักงานเกิดความไม่พอใจ แต่สามารถแก้ไขได้ภายในหน่วยงาน	พนักงานเกิดความไม่พอใจ และจำเป็นต้องอาศัยหน่วยงานกลาง (HR) ในการดำเนินการแก้ไข	พนักงานเกิดความไม่พอใจสูง และเกิดดารร้องเรียนผ่านช่องทางภายในบริษัท	พนักงานเกิดความไม่พอใจอย่างรุนแรง เช่นนัดหยุดงาน พนักงานลาออกจำนวนมากและส่งผลให้การดำเนินธุรกิจหยุดชะงักหรือเกิดข้อพิพาทจนต้องเข้าสู่กระบวนการทางกฏหมาย
					
					
	ความพึงพอใจของพนักงาน				
					
เกณฑ์การประเมินผลกระทบ (Impact)		ระดับ			
		ต่ำ	ปานกลาง	สูง	รุนแรง
		1	2	3	4
		เกิดผลกระทบต่อส่งแวดล้อมในบริเวณข้างเคียงเล็กน้อย แก้ไขได้โดยไม่ต้องมีมาตรการดำเนินการแก้ไข	เกิดผลกระทบต่อสิ่งแวดล้อมโดยสามารถดำเนินการแก้ไขภายใน 1 วันหรือใช้ระยะเวลาฟื้นฟูให้กลับคืนสภาพได้ ภายในระยะเวลา < 1 ปี 	เกิดผลกระทบต่อสิ่งแวดล้อมรุนแรงโดยสามารถดำเนินการแก้ไขในระยะเวลามากกว่า 1 วัน แต่ไม่เกิน 1 เดือนหรือใช้ระยะเวลาฟื้นฟูให้กลับคืนสภาพได้ ภายในระยะเวลา 1-5 ปี	เกิดผลกระทบต่อสิ่งแวดล้อมรุนแรงมากโดยสามารถดำเนินการแก้ไขในระยะเวลามากกว่า 1 เดือน หรือใช้ระยะเวลามากกว่า 5 ปีขึ้นไป ในการบรรเทา ฟื้นฟู หรือเสียหายจนยากต่อการฟื้นฟู
					
-4					
สิ่งแวดล้อม	สิ่งแวดล้อม				
(Environment)					
					
เกณฑ์การประเมินผลกระทบ (Impact)		ระดับ			
		ต่ำ	ปานกลาง	สูง	รุนแรง
		1	2	3	4
	ปริมาณการขายผลิตภัณฑ์ของ GPSC	ลูกค้าที่ไม่ใช่ลูกค้าหลัก ลดการซื้อ ผลิตภัณฑ์/บริการ	ลูกค้าที่ไม่ใช่ลูกค้าหลัก เลิกซื้อ ผลิตภัณฑ์/บริการ	ลูกค้าหลัก ลดการซื้อ ผลิตภัณฑ์/บริการ	ลูกค้าหลัก เลิกซื้อ ผลิตภัณฑ์/บริการ
-5					
ลูกค้า คู่ค้า					
(Customer)	ความพึงพอใจของลูกค้า คู่ค้า	ไม่มีผลกระทบ	ลูกค้า คู่ค้า แสดงความไม่พอใจร้องเรียนมาที่บริษัท	ลูกค้าแสดงความไม่พอใจผ่านสื่อต่างๆ	ลูกค้า คู่ค้า ฟ้องร้องบริษัท
					
เกณฑ์การประเมินผลกระทบ (Impact)		ระดับ			
		ต่ำ	ปานกลาง	สูง	รุนแรง
		1	2	3	4
		มีผลกระทบต่อกระบวนการผลิต กระบวนการดำเนินงานเล็กน้อย โดยอยู่ในระดับที่สามารถ ควบคุมและแก้ไขได้ด้วยตัวเอง	มีผลกระทบต่อกระบวนการผลิต กระบวนการดำเนินงาน โดยอยู่ในระดับที่สามารถ ควบคุมและแก้ไขได้โดยหน่วยงานที่เกี่ยวข้อง	ผลกระทบต่อกระบวนการผลิต กระบวนการดำเนินงาน โดยจำเป็นต้องหยุด ชะลอการดหเนินงานหลักบางส่วน	ผลกระทบต่อกระบวนการผลิต กระบวนการดำเนินงานอย่างรุนแรง โดยส่งผลกระทบต่อการส่งมอบ ผลิตภัณฑ์แก่ลูกค้า / การดำเนินงานและเป้าหมายตามแผนงาน
					
	ประสิทธิผลของกระบวนการ				
					
					
					
					
-6	ผลิตภัณฑ์หรือ บริการ	ไม่มีผลกระทบในการส่งมอบผลิตภัณฑ์/ บริการ	เกิดความล่าช้าในการส่งมอบผลิตภัณฑ์ บริการ หรือ ผลิตภัณฑ์ /บริการ ไม่ได้คุณภาพตามข้อกำหนด	ไม่สามารถส่งมอบผลิตภัณฑ์ บริการได้	ไม่สามารถส่งมอบผลิตภัณฑ์ บริการได้ ซึ่งทางบริษัทมีค่าใช้จ่ายเพิ่ม หรือถูกเรียกร้องค่าเสียหาย
กระบวนการทางธุรกิจ และการปฏิบัติการ	ระยะเวลาการดำเนินโครงการล่าช้า 				
(Operational)	(ตั้งแต่ BOD Approval จนถึง COD)	<3% จากแผนงานหรือ<1เดือน	3% < X <5% จากแผนงานหรือ< 2เดือน	5% < X <10% จากแผนงานหรือ< 3เดือน	ล่าช้าจากแผนงาน 10% หรือ > 3 เดือน
	การกำกับดูแล	ดำเนินงานเป็นไปตามแนวทาง/ นโยบาย GPSC โดยสามารถควบคุมได้	ดำเนินงานเป็นไปตามแนวทาง/ นโยบาย GPSC โดยไม่สามารถควบคุมได้	ไม่ดำเนินงานเตามแนวทาง/ นโยบาย ของGPSC	ไม่ดำเนินงานเตามแนวทาง/ นโยบาย ของGPSC และส่งผลเสียหายต่อ GPSC
					
เกณฑ์การประเมินผลกระทบ (Impact)		ระดับ			
		ต่ำ	ปานกลาง	สูง	รุนแรง
		1	2	3	4
			ทำให้เกิดความไม่พอใจต่อสาธารณะ เช่นการเขียนบทความวิจารย์	ทำให้เกิดความไม่พอใจอย่างมากต่อสาธารณะ เช่นการแสดงความเห็นคัดค้านผ่านสื่อต่างๆ	ทำให้เกิดการต่อต้านรุนแรงจากสาธารณะ เช่นการประท้วงจากชุมชน
	ภาพลักษณ์ของ GPSC ต่อสาธารณะ สื่อ	ไม่มีผลกระทบ			
					
-7					
ชื่อเสียงภาพลักษณ์ต่อองค์กร					
(Image)		มีผลกระทบต่อชุมชน รอบสถานประกอบการ โรงงานเล็กน้อย โดยได้รับคำติเตือนข้อครหาอย่างไม่เป็นทางการผ่านช่องทางต่างๆของบริษัท	มีผลกระทบต่อชุมชน รอบสถานประกอบการโดยได้ข้อร้องเรียนเป็นลายลักษณ์อักษร	มีผลกระทบต่อชุมชน รอบสถานประกอบการโดยได้ข้อร้องเรียนเป็นลายลักษณ์อักษรและถูกดำเนินการตรวจ สอบจากหน่วยงานกำกับดูแลจากภายนอก	มีผลกระทบรุนแรงต่อชุมชนเป็นบริเวณกว้าง โดยได้รับคำสั่งหยุดการดำเนินการ หรือถูกประท้วงจากมวลชนจนไม่สามารถดำเนินธุรกิจได้
					
	ภาพลักษณ์ GPSC				
	ต่อชุมชน				
"""

# Convert and print the JSON Lines output
json_lines_output = convert_tsv_to_json_lines(tsv_content, sheet_name="Risk_Criteria")
print(json_lines_output)
